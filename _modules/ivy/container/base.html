<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ivy.container.base &mdash; Ivy 1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="icon" type="image/png" href="https://github.com/unifyai/unifyai.github.io/blob/master/img/externally_linked/ivy_logo_only.png?raw=true">
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Ivy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../related_work.html">Related Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../deep_dive.html">Deep Dive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/experimental.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/control_flow_ops.html">Control flow ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/creation.html">Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/data_type.html">Data type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/device.html">Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/elementwise.html">Elementwise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/experimental.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/gradients.html">Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/linear_algebra.html">Linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/manipulation.html">Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/meta.html">Meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/nest.html">Nest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/random.html">Random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/searching.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/set.html">Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/sorting.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/statistical.html">Statistical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional/ivy/utility.html">Utility</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../data_classes/container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_classes/array.html">Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/module.html">Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/initializers.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/helpers.html">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/sequential.html">Sequential</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stateful/optimizers.html">Optimizers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Nested array</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nested_array/nested_array.html">Nested array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../ivy"">Ivy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mech"">Ivy mech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../vision"">Ivy vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../robot"">Ivy robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gym"">Ivy gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory"">Ivy memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../builder"">Ivy builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models"">Ivy models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ecosystem"">Ivy ecosystem</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Ivy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>ivy.container.base</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ivy.container.base</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Base Container Object.&quot;&quot;&quot;</span>

<span class="c1"># global</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">termcolor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">ivy.exceptions</span> <span class="kn">import</span> <span class="n">IvyBackendException</span><span class="p">,</span> <span class="n">IvyException</span>


<span class="k">try</span><span class="p">:</span>
    <span class="c1"># noinspection PyPackageRequirements</span>
    <span class="kn">import</span> <span class="nn">h5py</span>
<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="n">h5py</span> <span class="o">=</span> <span class="kc">None</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">set</span>

<span class="c1"># local</span>
<span class="kn">import</span> <span class="nn">ivy</span>


<span class="n">ansi_escape</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\x1B(?:[@-Z</span><span class="se">\\</span><span class="s2">-_]|\[[0-?]*[ -/]*[@-~])&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_is_jsonable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_repr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c1"># noinspection PyMissingConstructor</span>
<div class="viewcode-block" id="ContainerBase"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase">[docs]</a><span class="k">class</span> <span class="nc">ContainerBase</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
<div class="viewcode-block" id="ContainerBase.__init__"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dict_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">queues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">queue_load_sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">container_combine_method</span><span class="o">=</span><span class="s2">&quot;list_join&quot;</span><span class="p">,</span>
        <span class="n">queue_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">print_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">key_length_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">print_indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">print_line_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">default_key_color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
        <span class="n">keyword_color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">types_to_iteratively_nest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize container object from input dict representation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dict_in</span>
<span class="sd">            the dictionary the container should wrap around. Default is ``None``.</span>
<span class="sd">        queues</span>
<span class="sd">            Sequence of multiprocessing queues, each of which returns containers.</span>
<span class="sd">            This enables the current container to be passed around asynchronously while</span>
<span class="sd">            waiting for data. Default is ``None``.</span>
<span class="sd">        queue_load_sizes</span>
<span class="sd">            Size of leading dimension of the containers returned by each queue.</span>
<span class="sd">            Default is ``None``.</span>
<span class="sd">        container_combine_method</span>
<span class="sd">            The method to use for combining containers arriving from different queues.</span>
<span class="sd">            Default is ivy.Container.cont_list_join</span>
<span class="sd">        queue_timeout</span>
<span class="sd">            The timeout when waiting for containers to arrive from the queues.</span>
<span class="sd">            Default is global.</span>
<span class="sd">        print_limit</span>
<span class="sd">            The total array size limit when printing the container. Default is 10.</span>
<span class="sd">        key_length_limit</span>
<span class="sd">            The maximum key length when printing the container. Default is ``None``.</span>
<span class="sd">        print_indent</span>
<span class="sd">            The number of whitespaces to use for indenting when printing the container.</span>
<span class="sd">            Default is 4.</span>
<span class="sd">        print_line_spacing</span>
<span class="sd">            The number of extra newlines to use between keys when printing the</span>
<span class="sd">            container. Default is ``0``.</span>
<span class="sd">        ivyh</span>
<span class="sd">            Handle to ivy module to use for the calculations. Default is ``None``, which</span>
<span class="sd">            results in the global ivy.</span>
<span class="sd">        default_key_color</span>
<span class="sd">            The default key color for printing the container to the terminal.</span>
<span class="sd">            Default is &#39;green&#39;.</span>
<span class="sd">        keyword_color_dict</span>
<span class="sd">            A dict mapping keywords to their termcolor color codes for printing the</span>
<span class="sd">            container. (Default value = None)</span>
<span class="sd">        rebuild_child_containers</span>
<span class="sd">            Whether to rebuild container found in dict_in with these constructor params.</span>
<span class="sd">            Default is ``False``, in which case the original container are kept as are.</span>
<span class="sd">        types_to_iteratively_nest</span>
<span class="sd">            The data types to nest iteratively in the dict structure, each type must be</span>
<span class="sd">            iterable. Default is ``None``.</span>
<span class="sd">        alphabetical_keys</span>
<span class="sd">            Whether to sort the container keys alphabetically, or preserve the dict</span>
<span class="sd">            order. Default is ``True``.</span>
<span class="sd">        kwargs</span>
<span class="sd">            keyword arguments for dict creation. Default is ``None``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queues</span> <span class="o">=</span> <span class="n">queues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span> <span class="o">=</span> <span class="n">container_combine_method</span>
        <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;list_join&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_list_join</span><span class="p">,</span>
                    <span class="s2">&quot;concat&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">conts</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">queue_load_sizes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_timeout</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">queue_timeout</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_queue_timeout</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">dict_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;dict_in and **kwargs cannot both be specified for ivy.Container &quot;</span>
                <span class="s2">&quot;constructor, please specify one or the other, not both.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">print_limit</span><span class="o">=</span><span class="n">print_limit</span><span class="p">,</span>
            <span class="n">print_indent</span><span class="o">=</span><span class="n">print_indent</span><span class="p">,</span>
            <span class="n">key_length_limit</span><span class="o">=</span><span class="n">key_length_limit</span><span class="p">,</span>
            <span class="n">print_line_spacing</span><span class="o">=</span><span class="n">print_line_spacing</span><span class="p">,</span>
            <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">,</span>
            <span class="n">default_key_color</span><span class="o">=</span><span class="n">default_key_color</span><span class="p">,</span>
            <span class="n">keyword_color_dict</span><span class="o">=</span><span class="n">keyword_color_dict</span><span class="p">,</span>
            <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="n">rebuild_child_containers</span><span class="p">,</span>
            <span class="n">types_to_iteratively_nest</span><span class="o">=</span><span class="n">types_to_iteratively_nest</span><span class="p">,</span>
            <span class="n">alphabetical_keys</span><span class="o">=</span><span class="n">alphabetical_keys</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cont_inplace_update</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span><span class="p">)</span></div>

    <span class="c1"># Class Methods #</span>
    <span class="c1"># --------------#</span>

<div class="viewcode-block" id="ContainerBase.cont_multi_map_in_function"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_multi_map_in_function">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_multi_map_in_function</span><span class="p">(</span>
        <span class="n">fn</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">],</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">]:</span>
        <span class="n">inspect_fn</span> <span class="o">=</span> <span class="n">fn</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">inspect_fn</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span>
        <span class="n">arg_cont_idxs</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_argwhere</span><span class="p">(</span>
            <span class="n">args</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_ivy_container</span><span class="p">,</span> <span class="n">to_ignore</span><span class="o">=</span><span class="n">ivy</span><span class="o">.</span><span class="n">Container</span>
        <span class="p">)</span>
        <span class="n">kwarg_cont_idxs</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_argwhere</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_ivy_container</span><span class="p">,</span> <span class="n">to_ignore</span><span class="o">=</span><span class="n">ivy</span><span class="o">.</span><span class="n">Container</span>
        <span class="p">)</span>
        <span class="c1"># retrieve all the containers in args and kwargs</span>
        <span class="n">arg_conts</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">multi_index_nest</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">arg_cont_idxs</span><span class="p">)</span>
        <span class="n">num_arg_conts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg_conts</span><span class="p">)</span>
        <span class="n">kwarg_conts</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">multi_index_nest</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">kwarg_cont_idxs</span><span class="p">)</span>
        <span class="c1"># Combine the retrieved containers from args and kwargs into a single list</span>
        <span class="n">with_out</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">inspect_fn</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">with_out</span><span class="p">:</span>
            <span class="n">conts</span> <span class="o">=</span> <span class="n">arg_conts</span> <span class="o">+</span> <span class="n">kwarg_conts</span> <span class="o">+</span> <span class="p">[</span><span class="n">out</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conts</span> <span class="o">=</span> <span class="n">arg_conts</span> <span class="o">+</span> <span class="n">kwarg_conts</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;no containers found in arguments&quot;</span><span class="p">)</span>
        <span class="n">cont0</span> <span class="o">=</span> <span class="n">conts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">cont0</span><span class="o">.</span><span class="n">cont_ivy</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span>
        <span class="c1"># Get the function with the name fn_name, enabling containers to specify</span>
        <span class="c1"># their backends irrespective of global ivy&#39;s backend</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">with_out</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">arg_vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[:</span><span class="n">num_arg_conts</span><span class="p">]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">copy_nest</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">to_mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">set_nest_at_indices</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">arg_cont_idxs</span><span class="p">,</span> <span class="n">arg_vals</span><span class="p">)</span>
            <span class="n">kwarg_vals</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">num_arg_conts</span><span class="p">:]</span>
            <span class="n">kw</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">copy_nest</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">to_mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">set_nest_at_indices</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="n">kwarg_cont_idxs</span><span class="p">,</span> <span class="n">kwarg_vals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">with_out</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="c1"># Replace each container in arg and kwarg with the arrays at the leaf</span>
        <span class="c1"># levels of that container using map_fn and call fn using those arrays</span>
        <span class="c1"># as inputs</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_multi_map</span><span class="p">(</span>
            <span class="n">map_fn</span><span class="p">,</span>
            <span class="n">conts</span><span class="p">,</span>
            <span class="n">key_chains</span><span class="p">,</span>
            <span class="n">to_apply</span><span class="p">,</span>
            <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_nests</span><span class="o">=</span><span class="n">map_sequences</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="n">out</span><span class="o">.</span><span class="n">inplace_update</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out</span>

        <span class="c1"># Multiple containers for functions returning multiple arrays</span>
        <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">ret</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_ivy_array</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">cont_unstack_conts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_handle_inplace"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_handle_inplace">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_handle_inplace</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an inplace update of out, provided it is not None, by updating with</span>
<span class="sd">        the values in ret.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ret</span>
<span class="sd">            The container with the return values</span>
<span class="sd">        out</span>
<span class="sd">            The optional out container, which is primed for being overwritten if it</span>
<span class="sd">            exists</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            The out container, but filled with the values from the ret container</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="n">out</span><span class="o">.</span><span class="n">inplace_update</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_list_join"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_list_join">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_list_join</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Join containers of lists together along the specified dimension.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to list join</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            List joined containers, with each entry being a list of arrays</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container0</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
                    <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_list_join</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">containers</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContainerBase.cont_list_stack"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_list_stack">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_list_stack</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List stack containers together along the specified dimension.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to list stack</span>
<span class="sd">        dim</span>
<span class="sd">            dimension along which to list stack</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Stacked containers, with each entry being a list of arrays</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container0</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_list_stack</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">containers</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_cont_concat_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_cont_sum_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">to_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
            <span class="n">start</span><span class="o">=</span><span class="n">ivy</span><span class="o">.</span><span class="n">zeros</span><span class="p">([]),</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_cont_mean_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">_cont_sum_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>

<div class="viewcode-block" id="ContainerBase.cont_unify"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_unify">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unify a list of containers, on arbitrary devices, to a single container on</span>
<span class="sd">        the specified device.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to unify</span>
<span class="sd">        dev</span>
<span class="sd">            The device to unify the containers to.</span>
<span class="sd">        mode</span>
<span class="sd">            The mode by which to unify, must be one of [ concat | mean | sum ]</span>
<span class="sd">        axis</span>
<span class="sd">            The axis along which to concattenate the container, if concat mode is set.</span>
<span class="sd">            Default is ``0``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Unified container</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;concat&quot;</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">_cont_concat_unify</span><span class="p">,</span>
            <span class="s2">&quot;sum&quot;</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">_cont_sum_unify</span><span class="p">,</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">_cont_mean_unify</span><span class="p">,</span>
        <span class="p">}[</span><span class="n">mode</span><span class="p">](</span><span class="n">containers</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_combine"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_combine">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_combine</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine keys and values in a sequence of containers, with priority given to</span>
<span class="sd">        the right-most container in the case of duplicates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to compare</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as</span>
<span class="sd">            container_rightmost.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Combined containers</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if inputs are not dicts, then simply return the right-most value</span>
        <span class="n">container_rightmost</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container_rightmost</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">container_rightmost</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="c1"># noinspection PyUnresolvedReferences</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container_rightmost</span><span class="o">.</span><span class="n">cont_config</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container_rightmost</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>

        <span class="c1"># return if len==1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">container_rightmost</span>

        <span class="c1"># otherwise, check that the keys are aligned between each container, and apply</span>
        <span class="c1"># this method recursively</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">item</span>
                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">keys_present</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_combine</span><span class="p">(</span>
                <span class="o">*</span><span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">kp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">keys_present</span><span class="p">)</span> <span class="k">if</span> <span class="n">kp</span><span class="p">],</span>
                <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_diff"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_diff">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_diff</span><span class="p">(</span>
        <span class="o">*</span><span class="n">containers</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="n">diff_keys</span><span class="o">=</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span>
        <span class="n">detect_key_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">detect_value_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare keys and values in a sequence of containers, returning the single</span>
<span class="sd">        shared values where they are the same, and new nested sub-dicts with all values</span>
<span class="sd">        where they are different.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to compare</span>
<span class="sd">        mode</span>
<span class="sd">            The mode of the diff operation, returning either all keys and values,</span>
<span class="sd">            only those that are consist across the containers, or only the differences.</span>
<span class="sd">            Default is all.</span>
<span class="sd">        diff_keys</span>
<span class="sd">            The key/keys to add to the returned container when differences are found.</span>
<span class="sd">            Default is ``&quot;diff&quot;``.</span>
<span class="sd">        detect_key_diffs</span>
<span class="sd">            Whether to treat different keys as detected differences. If not, the keys</span>
<span class="sd">            among the input containers are simply combined without flagging differences.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        detect_value_diffs</span>
<span class="sd">            Whether to treat different values as detected differences.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        detect_shape_diffs</span>
<span class="sd">            Whether to treat different array shapes as detected differences.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        *containers</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Compared containers</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_elem_in_list</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;same_only&quot;</span><span class="p">,</span> <span class="s2">&quot;diff_only&quot;</span><span class="p">])</span>

        <span class="c1"># if inputs are not dicts, then compare their values to determine the diff dict</span>
        <span class="n">num_containers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container0</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">equality_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">detect_value_diffs</span><span class="p">:</span>
                <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">detect_shape_diffs</span><span class="p">:</span>
                <span class="n">shape_equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span>
                    <span class="n">equality_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">,</span> <span class="n">shape_equal_mat</span><span class="p">)</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">,</span> <span class="s2">&quot;int32&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;diff_only&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">container0</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;same_only&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cont_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_containers</span><span class="p">)</span>
                <span class="n">diff_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">cont_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cont_range</span><span class="p">,</span> <span class="n">containers</span><span class="p">))</span>
                <span class="n">idxs_added</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">cont_range</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">idxs_added</span><span class="p">:</span>
                        <span class="n">idxs_to_add</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                        <span class="n">idxs_to_add_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                            <span class="n">ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">idxs_to_add</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="n">diff_keys</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idxs_to_add_list</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="n">diff_keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                                <span class="s2">&quot;diff_keys must be either a string or list of strings,&quot;</span>
                                <span class="s2">&quot;but found </span><span class="si">{}</span><span class="s2"> of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                    <span class="n">diff_keys</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">)</span>
                                <span class="p">)</span>
                            <span class="p">)</span>
                        <span class="n">diff_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                        <span class="n">idxs_added</span> <span class="o">+=</span> <span class="n">idxs_to_add_list</span>
                <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">diff_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># otherwise, check that the keys are aligned between each container, and apply</span>
        <span class="c1"># this method recursively</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">item</span>
                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">keys_present</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">all_keys_present</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">keys_present</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_containers</span>
            <span class="k">if</span> <span class="n">all_keys_present</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_diff</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                    <span class="n">diff_keys</span><span class="o">=</span><span class="n">diff_keys</span><span class="p">,</span>
                    <span class="n">detect_key_diffs</span><span class="o">=</span><span class="n">detect_key_diffs</span><span class="p">,</span>
                    <span class="n">detect_value_diffs</span><span class="o">=</span><span class="n">detect_value_diffs</span><span class="p">,</span>
                    <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">detect_shape_diffs</span><span class="p">,</span>
                    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="n">res</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="nb">sum</span><span class="p">(</span><span class="n">keys_present</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">detect_key_diffs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="n">keys_present</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)][</span><span class="n">key</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="n">diff_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">key_present</span><span class="p">,</span> <span class="n">cont</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys_present</span><span class="p">,</span> <span class="n">containers</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">detect_key_diffs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key_present</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;same_only&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                            <span class="n">diff_dict</span><span class="p">[</span><span class="n">diff_keys</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">diff_dict</span><span class="p">[</span><span class="n">diff_keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                                <span class="s2">&quot;diff_keys must be either a string or list of strings,&quot;</span>
                                <span class="s2">&quot;but found </span><span class="si">{}</span><span class="s2"> of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                    <span class="n">diff_keys</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">)</span>
                                <span class="p">)</span>
                            <span class="p">)</span>
            <span class="k">if</span> <span class="n">diff_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff_dict</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_structural_diff"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_structural_diff">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_structural_diff</span><span class="p">(</span>
        <span class="o">*</span><span class="n">containers</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="n">diff_keys</span><span class="o">=</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span>
        <span class="n">detect_key_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare keys and shapes in a sequence of containers, returning the single</span>
<span class="sd">        shared values where they are the same, and new nested sub-dicts with all values</span>
<span class="sd">        where they are different.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to compare</span>
<span class="sd">        mode</span>
<span class="sd">            The mode of the diff operation, returning either all keys and values,</span>
<span class="sd">            only those that are consist across the containers, or only the differences.</span>
<span class="sd">            Default is all.</span>
<span class="sd">        diff_keys</span>
<span class="sd">            The key/keys to add to the returned container when differences are found.</span>
<span class="sd">            Default is &quot;diff&quot;.</span>
<span class="sd">        detect_key_diffs</span>
<span class="sd">            Whether to treat different keys as detected differences.</span>
<span class="sd">            If not, the keys among the input containers are simply combined without</span>
<span class="sd">            flagging differences. Default is ``True``.</span>
<span class="sd">        detect_shape_diffs</span>
<span class="sd">            Whether to treat different array shapes as detected differences.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        *containers</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Compared containers</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_diff</span><span class="p">(</span>
            <span class="o">*</span><span class="n">containers</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
            <span class="n">diff_keys</span><span class="o">=</span><span class="n">diff_keys</span><span class="p">,</span>
            <span class="n">detect_key_diffs</span><span class="o">=</span><span class="n">detect_key_diffs</span><span class="p">,</span>
            <span class="n">detect_value_diffs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">detect_shape_diffs</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_multi_map"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_multi_map">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_multi_map</span><span class="p">(</span>
        <span class="n">func</span><span class="p">,</span>
        <span class="n">containers</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">map_nests</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">assert_identical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply function to all array values from a collection of identically</span>
<span class="sd">        structured containers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func</span>
<span class="sd">            Function to apply to each container entry.</span>
<span class="sd">        containers</span>
<span class="sd">            containers to map.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains will</span>
<span class="sd">            be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied,</span>
<span class="sd">            otherwise the leftmost container value is used. Default is ``False``.</span>
<span class="sd">        key_chain</span>
<span class="sd">            Chain of keys for this dict entry (Default value = &#39;&#39;)</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        assert_identical</span>
<span class="sd">            Whether to assert that the input containers are identical or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">container0</span> <span class="o">=</span> <span class="n">cont</span>
                <span class="k">break</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span>
            <span class="n">container0</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No containers found in the inputs to ivy.Container.cont_multi_map&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container0</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">else</span> <span class="n">cont</span>
                <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span>
            <span class="p">]</span>
            <span class="n">value0</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">is_container</span> <span class="o">=</span> <span class="p">[</span><span class="n">ivy</span><span class="o">.</span><span class="n">is_ivy_container</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">_found_in_key_chains</span><span class="p">(</span><span class="n">this_key_chain</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">this_key_chain</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">key_chain</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">assert_identical</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">is_container</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">is_container</span><span class="p">):</span>
                <span class="n">found</span> <span class="o">=</span> <span class="n">_found_in_key_chains</span><span class="p">(</span><span class="n">this_key_chain</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">found</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value0</span>
                        <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_multi_map</span><span class="p">(</span>
                        <span class="n">func</span><span class="p">,</span>
                        <span class="n">values</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span>
                        <span class="n">to_apply</span><span class="p">,</span>
                        <span class="n">prune_unapplied</span><span class="p">,</span>
                        <span class="n">this_key_chain</span><span class="p">,</span>
                        <span class="n">config</span><span class="p">,</span>
                        <span class="n">map_nests</span><span class="p">,</span>
                        <span class="n">assert_identical</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
                <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">map_nests</span><span class="p">:</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_multi_map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">values</span><span class="p">,</span> <span class="n">to_ivy</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="n">_found_in_key_chains</span><span class="p">(</span><span class="n">this_key_chain</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">found</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                                <span class="k">continue</span>
                            <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value0</span>
                            <span class="k">continue</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
            <span class="c1"># noinspection PyProtectedMember</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_common_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_common_key_chains">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_common_key_chains</span><span class="p">(</span><span class="n">containers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the key-chains common across all containers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            Containers to check.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            list of key-chains.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cont_all_key_chains</span><span class="p">()</span>
        <span class="n">sets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">cont_all_key_chains</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">sets</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span></div>

<div class="viewcode-block" id="ContainerBase.cont_identical"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_identical">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_identical</span><span class="p">(</span>
        <span class="n">containers</span><span class="p">,</span>
        <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">same_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">arrays_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a single boolean as to whether the input containers have identical</span>
<span class="sd">        key-chains and data types.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>
<span class="sd">        check_types</span>
<span class="sd">            Whether to check if the datatypes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to check if the shapes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        same_arrays</span>
<span class="sd">            Whether to check if the arrays are the exact same instances.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        arrays_equal</span>
<span class="sd">            Whether to check if the arrays have equal values. Default is ``True``.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains will</span>
<span class="sd">            be skipped. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        key_chain</span>
<span class="sd">            Chain of keys for this dict entry (Default value = &#39;&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">partial</span><span class="p">:</span>
            <span class="n">common_key_chains</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_common_key_chains</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">common_key_chains</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">containers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">cont</span><span class="o">.</span><span class="n">cont_at_key_chains</span><span class="p">(</span><span class="n">common_key_chains</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span>
            <span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sl</span><span class="p">])</span>
        <span class="c1"># noinspection PyProtectedMember</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">value_0</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">type_0</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value_0</span><span class="p">)</span>
            <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">type_n</span> <span class="ow">is</span> <span class="n">type_0</span> <span class="k">for</span> <span class="n">type_n</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="ow">or</span> <span class="n">check_types</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">value_0</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">check_shapes</span><span class="p">:</span>
                    <span class="n">shape_0</span> <span class="o">=</span> <span class="n">value_0</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">shape_n</span> <span class="o">==</span> <span class="n">shape_0</span> <span class="k">for</span> <span class="n">shape_n</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">same_arrays</span><span class="p">:</span>
                    <span class="n">id_0</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">value_0</span><span class="p">)</span>
                    <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">id_n</span> <span class="o">==</span> <span class="n">id_0</span> <span class="k">for</span> <span class="n">id_n</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">arrays_equal</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical</span><span class="p">(</span>
                    <span class="n">values</span><span class="p">,</span>
                    <span class="n">check_types</span><span class="p">,</span>
                    <span class="n">check_shapes</span><span class="p">,</span>
                    <span class="n">same_arrays</span><span class="p">,</span>
                    <span class="n">arrays_equal</span><span class="p">,</span>
                    <span class="n">key_chains</span><span class="p">,</span>
                    <span class="n">to_apply</span><span class="p">,</span>
                    <span class="n">partial</span><span class="p">,</span>
                    <span class="n">this_key_chain</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ContainerBase.cont_assert_identical"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_assert_identical">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_assert_identical</span><span class="p">(</span>
        <span class="n">containers</span><span class="p">,</span>
        <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">same_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">arrays_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert whether the input containers are identical. Otherwise, the diff is</span>
<span class="sd">        shown in an exception.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>
<span class="sd">        check_types</span>
<span class="sd">            Whether to check if the datatypes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to check if the shapes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        same_arrays</span>
<span class="sd">            Whether to check if the arrays are the exact same instances.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        arrays_equal</span>
<span class="sd">            Whether to check if the arrays have equal values. Default is ``True``.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical</span><span class="p">(</span>
                <span class="n">containers</span><span class="p">,</span>
                <span class="n">check_types</span><span class="p">,</span>
                <span class="n">check_shapes</span><span class="p">,</span>
                <span class="n">same_arrays</span><span class="p">,</span>
                <span class="n">arrays_equal</span><span class="p">,</span>
                <span class="n">key_chains</span><span class="p">,</span>
                <span class="n">to_apply</span><span class="p">,</span>
                <span class="n">partial</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;Containers were not identical:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_identical_structure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_identical_structure">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_identical_structure</span><span class="p">(</span>
        <span class="n">containers</span><span class="p">,</span>
        <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a single boolean as to whether the input containers have identical</span>
<span class="sd">        structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>
<span class="sd">        check_types</span>
<span class="sd">            Whether to also check whether the datatypes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to also check whether the shapes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        key_chain</span>
<span class="sd">            Chain of keys for this dict entry (Default value = &#39;&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical</span><span class="p">(</span>
            <span class="n">containers</span><span class="p">,</span>
            <span class="n">check_types</span><span class="p">,</span>
            <span class="n">check_shapes</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="n">key_chains</span><span class="p">,</span>
            <span class="n">to_apply</span><span class="p">,</span>
            <span class="n">partial</span><span class="p">,</span>
            <span class="n">key_chain</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_assert_identical_structure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_assert_identical_structure">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_assert_identical_structure</span><span class="p">(</span>
        <span class="n">containers</span><span class="p">,</span>
        <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert whether the input containers have identical structure. Otherwise, the</span>
<span class="sd">        diff is shown in an exception.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>
<span class="sd">        check_types</span>
<span class="sd">            Whether to also check whether the datatypes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to also check whether the shapes of the leaf nodes are the same.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical_structure</span><span class="p">(</span>
                <span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">partial</span>
            <span class="p">),</span>
            <span class="s2">&quot;Containers did not have identical structure:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_structural_diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_identical_configs"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_identical_configs">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_identical_configs</span><span class="p">(</span><span class="n">containers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a single boolean as to whether the input containers all have</span>
<span class="sd">        identical configs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_greater</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="n">config0</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config0</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ContainerBase.cont_identical_array_shapes"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_identical_array_shapes">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_identical_array_shapes</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether all of the containers have identical number of arrays and</span>
<span class="sd">        identical array shapes, regardless of their key-chain structures.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to check.</span>
<span class="sd">        exclusive</span>
<span class="sd">            Whether to check if the data type is exclusively an array, rather than a</span>
<span class="sd">            variable or traced array. (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_conts</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">cont_size_ordered_arrays</span><span class="p">(</span><span class="n">exclusive</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="n">array_cont0</span> <span class="o">=</span> <span class="n">array_conts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">array_cont0_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_cont0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">array_cont</span> <span class="ow">in</span> <span class="n">array_conts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_cont</span><span class="p">)</span> <span class="o">!=</span> <span class="n">array_cont0_len</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">a0</span><span class="o">.</span><span class="n">shape</span>
                    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">array_cont</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">array_cont0</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="p">]</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ContainerBase.cont_from_disk_as_hdf5"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_from_disk_as_hdf5">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_from_disk_as_hdf5</span><span class="p">(</span>
        <span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">slice_obj</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load container object from disk, as an h5py file, at the specified hdf5</span>
<span class="sd">        filepath.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h5_obj_or_filepath</span>
<span class="sd">            Filepath where the container object is saved to disk, or h5 object.</span>
<span class="sd">        slice_obj</span>
<span class="sd">            slice object to slice all h5 elements. (Default value = slice(None))</span>
<span class="sd">        alphabetical_keys</span>
<span class="sd">            Whether to sort the container keys alphabetically, or preserve the dict</span>
<span class="sd">            order. Default is ``True``.</span>
<span class="sd">        ivyh</span>
<span class="sd">            Handle to ivy module to use for the calculations. Default is ``None``, which</span>
<span class="sd">            results in the global ivy.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container loaded from disk</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span>
            <span class="n">h5py</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;You must install python package h5py in order to load hdf5 </span><span class="se">\</span>
<span class="s2">            files from disk into a container.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">container_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="n">alphabetical_keys</span> <span class="k">else</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">container_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_from_disk_as_hdf5</span><span class="p">(</span>
                    <span class="n">value</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">,</span> <span class="n">ivyh</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">container_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">ivyh</span><span class="p">,</span> <span class="n">ivy</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">slice_obj</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                    <span class="s2">&quot;Item found inside h5_obj which was neither a Group nor a Dataset.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">container_dict</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_from_disk_as_pickled"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_from_disk_as_pickled">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_from_disk_as_pickled</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load container object from disk at the specified pickle filepath.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pickle_filepath</span>
<span class="sd">            Filepath where the container object is saved to disk.</span>
<span class="sd">        ivyh</span>
<span class="sd">            Handle to ivy module to use for the calculations. Default is ``None``, which</span>
<span class="sd">            results in the global ivy.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container loaded from disk</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)),</span>
            <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_ivy</span><span class="p">()</span></div>

<div class="viewcode-block" id="ContainerBase.cont_from_disk_as_json"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_from_disk_as_json">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_from_disk_as_json</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load container object from disk at the specified json filepath. If some</span>
<span class="sd">        objects were not json-able during saving, then they will be loaded as strings.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        json_filepath</span>
<span class="sd">            Filepath where the container object is saved to disk.</span>
<span class="sd">        ivyh</span>
<span class="sd">            Handle to ivy module to use for the calculations. Default is ``None``, which</span>
<span class="sd">            results in the global ivy.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container loaded from disk</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_data_file</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_data_file</span><span class="p">),</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.h5_file_size"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.h5_file_size">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">h5_file_size</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get file size of h5 file contents.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h5_obj_or_filepath</span>
<span class="sd">            Filepath where the container object is saved to disk, or h5 object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Size of h5 file contents, and batch size.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span>
            <span class="n">h5py</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;You must install python package h5py in order to determine </span><span class="se">\</span>
<span class="s2">            the size of hdf5 files.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>

        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">size_to_add</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">h5_file_size</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="n">size_to_add</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">value_shape</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">value_shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
                <span class="n">batch_size</span> <span class="o">=</span> <span class="n">value_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                    <span class="s2">&quot;Item found inside h5_obj which was neither a Group nor a Dataset.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span><span class="p">,</span> <span class="n">batch_size</span></div>

<div class="viewcode-block" id="ContainerBase.shuffle_h5_file"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.shuffle_h5_file">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">shuffle_h5_file</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">seed_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shuffle entries in all datasets of h5 file, such that they are still aligned</span>
<span class="sd">        along axis 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h5_obj_or_filepath</span>
<span class="sd">            Filepath where the container object is saved to disk, or h5 object.</span>
<span class="sd">        seed_value</span>
<span class="sd">            random seed to use for array shuffling (Default value = 0)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span>
            <span class="n">h5py</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;You must install python package h5py in order to shuffle </span><span class="se">\</span>
<span class="s2">            hdf5 files on disk.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">seed_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed_value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">shuffle_h5_file</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">seed_value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
                <span class="c1"># noinspection PyTypeChecker</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                    <span class="s2">&quot;Item found inside h5_obj which was neither a Group nor a Dataset.&quot;</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">):</span>
            <span class="n">h5_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="ContainerBase.cont_reduce"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_reduce">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_reduce</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce containers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        containers</span>
<span class="sd">            containers to reduce</span>
<span class="sd">        reduction</span>
<span class="sd">            the reduction function</span>
<span class="sd">        config</span>
<span class="sd">            The configuration for the containers. Default is the same as container0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            reduced containers</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">container0</span><span class="o">.</span><span class="n">cont_config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_reduce</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">reduction</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># noinspection PyBroadException</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">reduction</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Container reduce operation only valid for containers of arrays&quot;</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_flatten_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_flatten_key_chain">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_flatten_key_chain</span><span class="p">(</span>
        <span class="n">key_chain</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            param replacement: (Default value = &#39;__&#39;)</span>
<span class="sd">        above_height</span>
<span class="sd">            Default value = None)</span>
<span class="sd">        below_depth</span>
<span class="sd">            Default value = None)</span>
<span class="sd">        replacement</span>
<span class="sd">             (Default value = &#39;__&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># noinspection RegExpSingleCharAlternation</span>
        <span class="n">flat_keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/|\.&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>  <span class="c1"></span>
        <span class="n">num_keys</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_keys</span><span class="p">)</span>
        <span class="n">pre_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">post_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">above_height</span> <span class="ow">and</span> <span class="n">num_keys</span> <span class="o">&gt;</span> <span class="n">above_height</span><span class="p">:</span>
            <span class="n">post_keys</span> <span class="o">=</span> <span class="n">flat_keys</span><span class="p">[</span><span class="o">-</span><span class="n">above_height</span><span class="p">:]</span>
            <span class="k">del</span> <span class="n">flat_keys</span><span class="p">[</span><span class="o">-</span><span class="n">above_height</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">below_depth</span> <span class="ow">and</span> <span class="n">num_keys</span> <span class="o">&gt;</span> <span class="n">below_depth</span><span class="p">:</span>
            <span class="n">pre_keys</span> <span class="o">=</span> <span class="n">flat_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">below_depth</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">flat_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">below_depth</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">k</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_keys</span><span class="p">),</span>
                    <span class="n">replacement</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flat_keys</span><span class="p">),</span>
                    <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">post_keys</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">k</span>
            <span class="p">]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_trim_key"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_trim_key">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cont_trim_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">max_length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>
<span class="sd">        Returns a trimmed key with a maximum length of max_length.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key</span>
<span class="sd">            key to trim</span>
<span class="sd">        max_length</span>
<span class="sd">            maximum length of key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">max_length</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key_len</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
                <span class="p">(</span><span class="n">key_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">max_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_length</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">key</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">])</span></div>

    <span class="c1"># Private Methods #</span>
    <span class="c1"># ----------------#</span>

    <span class="k">def</span> <span class="nf">_cont_call_static_method_with_flexible_args</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">static_method</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">kw</span><span class="p">,</span>
        <span class="n">required</span><span class="p">,</span>
        <span class="n">defaults</span><span class="p">,</span>
        <span class="n">self_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">num_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span> <span class="k">else</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">num_args</span>
            <span class="p">}</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self_idx</span> <span class="o">&gt;</span> <span class="n">num_args</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">self_idx</span> <span class="o">-</span> <span class="n">num_args</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">self_idx</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">static_method</span><span class="p">(</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kw</span><span class="p">,</span>
                <span class="n">key_chains</span><span class="o">=</span><span class="n">key_chains</span><span class="p">,</span>
                <span class="n">to_apply</span><span class="o">=</span><span class="n">to_apply</span><span class="p">,</span>
                <span class="n">prune_unapplied</span><span class="o">=</span><span class="n">prune_unapplied</span><span class="p">,</span>
                <span class="n">map_sequences</span><span class="o">=</span><span class="n">map_sequences</span><span class="p">,</span>
                <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">self_set</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># set to leftmost non-specified required arg, if present</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">required</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
                <span class="n">self_set</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="c1"># go through each key and value of the keyword arguments</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">self_set</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
                        <span class="c1"># if self is set and a default value exists, set it</span>
                        <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># otherwise set self to this argument</span>
                    <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
                    <span class="n">self_set</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># call the static method</span>
        <span class="k">return</span> <span class="n">static_method</span><span class="p">(</span>
            <span class="o">**</span><span class="n">kw</span><span class="p">,</span>
            <span class="n">key_chains</span><span class="o">=</span><span class="n">key_chains</span><span class="p">,</span>
            <span class="n">to_apply</span><span class="o">=</span><span class="n">to_apply</span><span class="p">,</span>
            <span class="n">prune_unapplied</span><span class="o">=</span><span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="o">=</span><span class="n">map_sequences</span><span class="p">,</span>
            <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cont_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sub_shapes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">is_native_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">v</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_shapes</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sub_shapes</span>
        <span class="n">min_num_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">sub_shape</span> <span class="ow">in</span> <span class="n">sub_shapes</span><span class="p">])</span>
        <span class="n">sub_shapes_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="p">[</span><span class="n">sub_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">min_num_dims</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_shape</span> <span class="ow">in</span> <span class="n">sub_shapes</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">sub_shapes_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub_shapes_array</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">sub_shapes_array</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">sub_shapes_array</span> <span class="o">/</span> <span class="n">sub_shapes_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="kc">None</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">mask</span><span class="p">,</span> <span class="n">sub_shapes_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">min_num_dims</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_cont_get_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cont_get_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_native</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">sub_devs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">dev</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_native</span><span class="o">=</span><span class="n">as_native</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">is_native_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>
                <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">v</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sub_devs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sub_devs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_cont_at_key_chains_input_as_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">return_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="nb">dict</span><span class="p">(),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_at_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ignore_key_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">return_cont</span><span class="o">.</span><span class="n">cont_set_at_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="k">def</span> <span class="nf">_cont_at_key_chains_input_as_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">current_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">current_chain</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">new_current_chain</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_current_chain</span> <span class="o">=</span> <span class="n">current_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">k</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_at_key_chains_input_as_dict</span><span class="p">(</span>
                    <span class="n">v</span><span class="p">,</span> <span class="n">new_current_chain</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_at_key_chain</span><span class="p">(</span>
                    <span class="n">new_current_chain</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">ignore_key_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cont_prune_key_chains_input_as_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">):</span>
        <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="n">return_cont</span><span class="o">.</span><span class="n">cont_prune_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="k">def</span> <span class="nf">_cont_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">return_cont</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">return_cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ret_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">ret_cont</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="c1"># Public Methods #</span>
    <span class="c1"># ---------------#</span>

<div class="viewcode-block" id="ContainerBase.cont_duplicate_array_keychains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_duplicate_array_keychains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_duplicate_array_keychains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">duplciates</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">key_chains</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_all_key_chains</span><span class="p">()</span>
        <span class="n">skips</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)):</span>
            <span class="n">temp_duplicates</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">if</span> <span class="n">key_chains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">skips</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">key_chains</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">skips</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">key_chains</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">[</span><span class="n">key_chains</span><span class="p">[</span><span class="n">j</span><span class="p">]]:</span>
                    <span class="k">if</span> <span class="n">key_chains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp_duplicates</span><span class="p">:</span>
                        <span class="n">temp_duplicates</span> <span class="o">+=</span> <span class="p">(</span><span class="n">key_chains</span><span class="p">[</span><span class="n">i</span><span class="p">],)</span>
                    <span class="k">if</span> <span class="n">key_chains</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp_duplicates</span><span class="p">:</span>
                        <span class="n">temp_duplicates</span> <span class="o">+=</span> <span class="p">(</span><span class="n">key_chains</span><span class="p">[</span><span class="n">j</span><span class="p">],)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_duplicates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">duplciates</span> <span class="o">+=</span> <span class="p">(</span><span class="n">temp_duplicates</span><span class="p">,)</span>
            <span class="n">skips</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">duplciates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">duplciates</span></div>

<div class="viewcode-block" id="ContainerBase.cont_update_config"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_update_config">[docs]</a>    <span class="k">def</span> <span class="nf">cont_update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="n">new_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">att_name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">k</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;types_to_iteratively_nest&quot;</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="p">(),</span> <span class="n">catch_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;keyword_color_dict&quot;</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;ivyh&quot;</span><span class="p">:</span>
                    <span class="n">att_name</span> <span class="o">=</span> <span class="s2">&quot;_local_ivy&quot;</span>
                <span class="n">new_config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">att_name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">new_config</span></div>

<div class="viewcode-block" id="ContainerBase.cont_inplace_update"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_inplace_update">[docs]</a>    <span class="k">def</span> <span class="nf">cont_inplace_update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">dict_in</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">config</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the contents of this container inplace, using either a new dict or</span>
<span class="sd">        container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dict_in</span>
<span class="sd">            New dict or container to update the current container inplace with.</span>
<span class="sd">        **config</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># update config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cont_update_config</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># update container values inplace</span>
        <span class="k">if</span> <span class="n">dict_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">dict_types</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">dict</span><span class="p">]</span> <span class="o">+</span> <span class="n">ivy</span><span class="o">.</span><span class="n">container_types</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="n">dict_types</span><span class="p">):</span>
            <span class="n">dict_in</span> <span class="o">=</span> <span class="n">dict_in</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">)):</span>
            <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;it_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_in</span><span class="p">)))))</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_in</span><span class="p">))</span>
                    <span class="p">],</span>
                    <span class="n">dict_in</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span><span class="s2">&quot;invalid input </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dict_in</span><span class="p">))</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_in</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alphabetical_keys</span> <span class="k">else</span> <span class="n">dict_in</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dict_types</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rebuild_child_containers</span>
                <span class="p">)</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">)):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">cont_inplace_update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="ContainerBase.cont_all_true"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_all_true">[docs]</a>    <span class="k">def</span> <span class="nf">cont_all_true</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether all the entries in the container boolean evaluate to True.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        assert_is_bool</span>
<span class="sd">            Whether or not to assert each entry is of type Boolean.</span>
<span class="sd">            (Default value = False)</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Boolean, whether all entries are boolean True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_as_bools</span><span class="p">(</span>
                        <span class="n">assert_is_bool</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span>
                        <span class="n">to_apply</span><span class="p">,</span>
                        <span class="n">prune_unapplied</span><span class="p">,</span>
                        <span class="n">map_sequences</span><span class="p">,</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_all_false"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_all_false">[docs]</a>    <span class="k">def</span> <span class="nf">cont_all_false</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether all the entries in the container boolean evaluate to False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        assert_is_bool</span>
<span class="sd">            Whether or not to assert each entry is of type Boolean.</span>
<span class="sd">            (Default value = False)</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Boolean, whether all entries are boolean False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_as_bools</span><span class="p">(</span>
                        <span class="n">assert_is_bool</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span>
                        <span class="n">to_apply</span><span class="p">,</span>
                        <span class="n">prune_unapplied</span><span class="p">,</span>
                        <span class="n">map_sequences</span><span class="p">,</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_slice_via_key"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_slice_via_key">[docs]</a>    <span class="k">def</span> <span class="nf">cont_slice_via_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slice_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get slice of container, based on key.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        slice_key</span>
<span class="sd">            key to slice container at.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container object sliced at desired key.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">slice_key</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_slice_via_key</span><span class="p">(</span><span class="n">slice_key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_as_bools"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_as_bools">[docs]</a>    <span class="k">def</span> <span class="nf">cont_as_bools</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return boolean evaluation for all nested items in the container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        assert_is_bool</span>
<span class="sd">            Whether or not to assert the entry is of type Boolean.</span>
<span class="sd">            (Default value = False)</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container object with all entries boolean evaluated.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_ret_bool</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">assert_is_bool</span><span class="p">:</span>
                <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">x</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">_ret_bool</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
            <span class="n">key_chains</span><span class="p">,</span>
            <span class="n">to_apply</span><span class="p">,</span>
            <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_unstack_conts"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_unstack_conts">[docs]</a>    <span class="k">def</span> <span class="nf">cont_unstack_conts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unstack containers along specified dimension.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis</span>
<span class="sd">            Dimensions along which to unstack.</span>
<span class="sd">        keepdims</span>
<span class="sd">            Whether to keep dimension 1 in the unstack dimensions. Default is ``False``.</span>
<span class="sd">        dim_size</span>
<span class="sd">            Size of the dimension to unstack. Determined from inputs by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            List of containers, unstacked along the specified dimension.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">keepdims</span><span class="p">:</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="bp">self</span><span class="p">[</span>
                    <span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">axis</span> <span class="o">+</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_size</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">i</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">axis</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">])]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_size</span><span class="p">)</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="ContainerBase.split_conts"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.split_conts">[docs]</a>    <span class="k">def</span> <span class="nf">split_conts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">num_or_size_splits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">with_remainder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Splits a container into multiple sub-containers, by splitting their</span>
<span class="sd">        constituent arrays.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_or_size_splits</span>
<span class="sd">            Number of equal arrays to divide the array into along the given axis if an</span>
<span class="sd">            integer. The size of each split element if a sequence of integers. Default</span>
<span class="sd">            is to divide into as many 1-dimensional arrays as the axis dimension.</span>
<span class="sd">        axis</span>
<span class="sd">            The axis along which to split, default is ``0``.</span>
<span class="sd">        with_remainder</span>
<span class="sd">            If the tensor does not split evenly, then store the last remainder entry.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains will</span>
<span class="sd">            be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied. Default</span>
<span class="sd">            is False.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            A list of sub-arrays.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dim_size</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">num_or_size_splits</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_or_size_splits</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_or_size_splits</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">num_or_size_splits</span><span class="o">=</span><span class="n">num_or_size_splits</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                <span class="n">with_remainder</span><span class="o">=</span><span class="n">with_remainder</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">is_native_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
            <span class="n">key_chains</span><span class="p">,</span>
            <span class="n">to_apply</span><span class="p">,</span>
            <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">cont_unstack_conts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="n">dim_size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_num_arrays"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_num_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">cont_num_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the number of arrays present at the leaf nodes, including variables</span>
<span class="sd">        by default.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exclusive</span>
<span class="sd">            Whether to check if the data type is exclusively an array,</span>
<span class="sd">            rather than a variable or traced array. (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="n">exclusive</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">cont_to_iterator_values</span><span class="p">()</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_size_ordered_arrays"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_size_ordered_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">cont_size_ordered_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a container with keychains mapped to flat keys, and arrays given in</span>
<span class="sd">        order of smallest to largest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exclusive</span>
<span class="sd">            Whether to check if the data type is exclusively an array,</span>
<span class="sd">            rather than a variable or traced array. (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_flatten_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">):</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="n">exclusive</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">array_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_disk_as_hdf5"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_disk_as_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_disk_as_hdf5</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">starting_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save container object to disk, as an h5py file, at the specified filepath.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h5_obj_or_filepath</span>
<span class="sd">            Filepath for where to save the container to disk, or h5 object.</span>
<span class="sd">        starting_index</span>
<span class="sd">            Batch index for which to start writing to file, if it already exists</span>
<span class="sd">            (Default value = 0)</span>
<span class="sd">        mode</span>
<span class="sd">            H5 read/write mode for writing to disk, [&#39;r&#39;, &#39;r+&#39;, &#39;w&#39;, &#39;w-&#39;, &#39;a&#39;],</span>
<span class="sd">            default is &#39;a&#39;.</span>
<span class="sd">        max_batch_size</span>
<span class="sd">            Maximum batch size for the container on disk, this is useful if later</span>
<span class="sd">            appending to file. (Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_exists</span><span class="p">(</span>
            <span class="n">h5py</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;You must install python package h5py in order to save </span><span class="se">\</span>
<span class="s2">            containers to disk as hdf5 files.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">h5_group</span> <span class="o">=</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">h5_group</span> <span class="o">=</span> <span class="n">h5_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">value</span><span class="o">.</span><span class="n">cont_to_disk_as_hdf5</span><span class="p">(</span>
                    <span class="n">h5_group</span><span class="p">,</span> <span class="n">starting_index</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">max_batch_size</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_as_np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">value_shape</span> <span class="o">=</span> <span class="n">value_as_np</span><span class="o">.</span><span class="n">shape</span>
                <span class="n">this_batch_size</span> <span class="o">=</span> <span class="n">value_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">max_batch_size</span><span class="p">:</span>
                    <span class="n">max_batch_size</span> <span class="o">=</span> <span class="n">starting_index</span> <span class="o">+</span> <span class="n">this_batch_size</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dataset_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_batch_size</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">value_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="n">maxshape</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dataset_shape</span><span class="p">]</span>
                    <span class="n">h5_obj</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
                        <span class="n">key</span><span class="p">,</span> <span class="n">dataset_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">value_as_np</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">maxshape</span><span class="o">=</span><span class="n">maxshape</span>
                    <span class="p">)</span>
                <span class="n">space_left</span> <span class="o">=</span> <span class="n">max_batch_size</span> <span class="o">-</span> <span class="n">starting_index</span>
                <span class="n">amount_to_write</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">this_batch_size</span><span class="p">,</span> <span class="n">space_left</span><span class="p">)</span>
                <span class="n">h5_obj</span><span class="p">[</span><span class="n">key</span><span class="p">][</span>
                    <span class="n">starting_index</span> <span class="p">:</span> <span class="n">starting_index</span> <span class="o">+</span> <span class="n">amount_to_write</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">value_as_np</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">amount_to_write</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_disk_as_pickled"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_disk_as_pickled">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_disk_as_pickled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_filepath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save container object to disk, as an pickled file, at the specified filepath.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pickle_filepath</span>
<span class="sd">            Filepath for where to save the container to disk.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">(),</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_jsonable"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_jsonable">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_jsonable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_dict</span>
<span class="sd">            Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">return_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_jsonable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_jsonable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_dict</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_disk_as_json"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_disk_as_json">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_disk_as_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_filepath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save container object to disk, as an json file, at the specified filepath.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        json_filepath</span>
<span class="sd">            Filepath for where to save the container to disk.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_data_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont_to_jsonable</span><span class="p">()</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">(),</span> <span class="n">json_data_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_nested_list"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_nested_list">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_nested_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">return_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">cont_to_nested_list</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;_f&quot;</span><span class="p">:</span>
                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_raw"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_raw">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor to their original form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">             Container data in its raw form.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_item</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_raw</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;it_&quot;</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">):</span>
                <span class="n">return_item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">cont_to_raw</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>
                        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">return_item</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_dict"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            ret Container as nested dict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">return_dict</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_iterator"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_iterator">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            Default value = &#39;&#39;)</span>
<span class="sd">        leaf_keys_only</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        include_empty</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Iterator for the container elements.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">leaf_keys_only</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">key</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="p">,</span> <span class="n">include_empty</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">kc</span><span class="p">,</span> <span class="n">value</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_iterator_values"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_iterator_values">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_iterator_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include_empty</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Iterator for the container values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="c1"># noinspection PyCompatibility</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_iterator_values</span><span class="p">(</span><span class="n">include_empty</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">value</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_iterator_keys"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_iterator_keys">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_iterator_keys</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            Default value = &#39;&#39;)</span>
<span class="sd">        leaf_keys_only</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        include_empty</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Iterator for the container elements.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">leaf_keys_only</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">key</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="c1"># noinspection PyCompatibility</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_iterator_keys</span><span class="p">(</span>
                    <span class="n">kc</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="p">,</span> <span class="n">include_empty</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">kc</span></div>

<div class="viewcode-block" id="ContainerBase.cont_to_flat_list"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_to_flat_list">[docs]</a>    <span class="k">def</span> <span class="nf">cont_to_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container as flat list.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()])</span></div>

<div class="viewcode-block" id="ContainerBase.cont_from_flat_list"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_from_flat_list">[docs]</a>    <span class="k">def</span> <span class="nf">cont_from_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return new container object with the same hierarchy, but with values replaced</span>
<span class="sd">        from flat list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        flat_list</span>
<span class="sd">            flat list of values to populate container with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_from_flat_list</span><span class="p">(</span><span class="n">flat_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">flat_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_has_key"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_has_key">[docs]</a>    <span class="k">def</span> <span class="nf">cont_has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether container object has specified key somewhere in the nested</span>
<span class="sd">        structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query_key</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_key</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            x</span>
<span class="sd">                param kc:</span>
<span class="sd">            kc</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">nonlocal</span> <span class="n">has_key</span>
            <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc</span><span class="p">:</span>
                <span class="n">has_key</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">has_key</span></div>

<div class="viewcode-block" id="ContainerBase.cont_has_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_has_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">cont_has_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether container object has specified key-chain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ContainerBase.cont_find_sub_container"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_find_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">cont_find_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont_to_find</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the sub-container in the current container if it exsits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont_to_find</span>
<span class="sd">            The sub-container to find.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_chain_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">_check_sub_cont</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="n">sub_cont_key_chains</span> <span class="o">=</span> <span class="n">sub_cont_to_find</span><span class="o">.</span><span class="n">cont_all_key_chains</span><span class="p">()</span>
            <span class="n">kcs_in_sub_cont</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont_key_chains</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">kcs_in_sub_cont</span>
                <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">kcs_in_sub_cont</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">sub_cont_to_find</span><span class="p">],</span> <span class="n">partial</span><span class="o">=</span><span class="n">partial</span>
                <span class="p">)</span>
            <span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">key_chain_found</span>
                <span class="n">key_chain_found</span> <span class="o">=</span> <span class="n">kc</span>
            <span class="k">return</span> <span class="n">sub_cont</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_check_sub_cont</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">key_chain_found</span></div>

<div class="viewcode-block" id="ContainerBase.cont_contains_sub_container"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_contains_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">cont_contains_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether the current container contains the sub-container, with</span>
<span class="sd">        matching structure and array values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont</span>
<span class="sd">            The sub-container to check.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont_find_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">else</span> <span class="kc">False</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_assert_contains_sub_container"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_assert_contains_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">cont_assert_contains_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Asserts that the current container contains the sub-container, otherwise</span>
<span class="sd">        exception raised with the diff printed to screen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont</span>
<span class="sd">            The sub-container to check.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cont_contains_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">:</span>
            <span class="n">key_chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_find_sub_structure</span><span class="p">(</span>
                <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key_chain</span><span class="p">:</span>
                <span class="n">key_chain</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;Containers did not have identical structure and values:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key_chain</span><span class="p">],</span> <span class="n">sub_cont</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_find_sub_structure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_find_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">cont_find_sub_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sub_struc_to_find</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the sub-container structure in the current container if it exsits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_struc_to_find</span>
<span class="sd">            The sub-container to find.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to check array shapes in the sub-structure. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_chain_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">_check_sub_cont</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            sub_cont</span>
<span class="sd">                param kc:</span>
<span class="sd">            kc</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">sub_struc_key_chains</span> <span class="o">=</span> <span class="n">sub_struc_to_find</span><span class="o">.</span><span class="n">cont_all_key_chains</span><span class="p">()</span>
            <span class="n">kcs_in_sub_cont</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_struc_key_chains</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">kcs_in_sub_cont</span>
                <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">kcs_in_sub_cont</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_identical_structure</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">sub_struc_to_find</span><span class="p">],</span>
                    <span class="n">check_shapes</span><span class="o">=</span><span class="n">check_shapes</span><span class="p">,</span>
                    <span class="n">partial</span><span class="o">=</span><span class="n">partial</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">key_chain_found</span>
                <span class="n">key_chain_found</span> <span class="o">=</span> <span class="n">kc</span>
            <span class="k">return</span> <span class="n">sub_cont</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_check_sub_cont</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">key_chain_found</span></div>

<div class="viewcode-block" id="ContainerBase.cont_contains_sub_structure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_contains_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">cont_contains_sub_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine whether the current container contains the sub-container structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont</span>
<span class="sd">            The sub-container to check.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to check array shapes in the sub-structure. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cont_find_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span> <span class="nb">str</span>
            <span class="p">)</span>
            <span class="k">else</span> <span class="kc">False</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_assert_contains_sub_structure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_assert_contains_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">cont_assert_contains_sub_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Asserts that the current container contains the sub-container structure,</span>
<span class="sd">        otherwise exception raised with the diff printed to screen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont</span>
<span class="sd">            The sub-container to check.</span>
<span class="sd">        check_shapes</span>
<span class="sd">            Whether to check array shapes in the sub-structure. Default is ``True``.</span>
<span class="sd">        partial</span>
<span class="sd">            Whether to also check for partially complete sub-containers.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cont_contains_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">partial</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">:</span>
            <span class="n">key_chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_find_sub_structure</span><span class="p">(</span>
                <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key_chain</span><span class="p">:</span>
                <span class="n">key_chain</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;Containers did not have identical structure:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_structural_diff</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">[</span><span class="n">key_chain</span><span class="p">],</span>
                        <span class="n">sub_cont</span><span class="p">,</span>
                        <span class="n">detect_key_diffs</span><span class="o">=</span><span class="ow">not</span> <span class="n">partial</span><span class="p">,</span>
                        <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">check_shapes</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;diff_only&quot;</span> <span class="k">if</span> <span class="n">partial</span> <span class="k">else</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_at_keys"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_at_keys">[docs]</a>    <span class="k">def</span> <span class="nf">cont_at_keys</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query container object at specified keys, either as list or nested dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        queries</span>
<span class="sd">            The keys to query.</span>
<span class="sd">        ignore_none</span>
<span class="sd">            Whether to ignore None input. Default is ``True``.</span>
<span class="sd">        containing</span>
<span class="sd">            Whether to include keys which only contain the query substrings.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        ignore_key_errors</span>
<span class="sd">            Whether to ignore Key-errors when trying to access the dict.</span>
<span class="sd">            Default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            sub-container containing only key-chains containing the specified keys.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">queries</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">key_chains_to_keep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">queries</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">key_chains_to_keep</span>
            <span class="n">kc_split</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">kc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc_split</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">containing</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">([</span><span class="n">query_key</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kc_split</span><span class="p">])</span>
                <span class="p">):</span>
                    <span class="n">key_chains_to_keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_at_key_chains</span><span class="p">(</span>
            <span class="n">key_chains_to_keep</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_at_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">cont_at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query container object at a specified key-chain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            param ignore_key_errors: (Default value = False)</span>
<span class="sd">        ignore_key_errors</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            sub-container or value at specified key chain</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ignore_key_errors</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_at_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_at_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query container object at specified key-chains, either as list or nested</span>
<span class="sd">        dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chains</span>
<span class="sd">            param ignore_none: (Default value = True)</span>
<span class="sd">        ignore_key_errors</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        ignore_none</span>
<span class="sd">             (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            sub-container containing only the specified key chains</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_at_key_chains_input_as_seq</span><span class="p">(</span>
                <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_at_key_chains_input_as_dict</span><span class="p">(</span>
                <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_at_key_chains_input_as_seq</span><span class="p">(</span>
                <span class="p">[</span><span class="n">key_chains</span><span class="p">],</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid type for input key_chains, must either be a list, tuple, dict&quot;</span>
                <span class="s2">&quot; or ivy.Container, but found type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key_chains</span><span class="p">))</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_all_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_all_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_all_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include_empty</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">kc</span> <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)]</span></div>

<div class="viewcode-block" id="ContainerBase.cont_key_chains_containing"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_key_chains_containing">[docs]</a>    <span class="k">def</span> <span class="nf">cont_key_chains_containing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_str</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_str</span>
<span class="sd">            param include_empty: (Default value = False)</span>
<span class="sd">        include_empty</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">kc</span>
            <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sub_str</span> <span class="ow">in</span> <span class="n">kc</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="ContainerBase.cont_set_at_keys"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_set_at_keys">[docs]</a>    <span class="k">def</span> <span class="nf">cont_set_at_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set values of container object at specified keys.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_dict</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            new container with updated value at each key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">cont_set_at_keys</span><span class="p">(</span><span class="n">target_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_set_at_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_set_at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">cont_set_at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set value of container object at a specified key-chain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            param val:</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        val</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            new container with updated value at key chain</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">cont</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_cont</span><span class="p">:</span>
                <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">sub_cont</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_overwrite_at_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_overwrite_at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">cont_overwrite_at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Overwrite value of container object at a specified key-chain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>
<span class="sd">            param val:</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        val</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            new container with updated value at key chain, provided it existed before.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">cont</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_elem_in_list</span><span class="p">(</span>
                <span class="n">key</span><span class="p">,</span>
                <span class="n">sub_cont</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;key chain must already exist in container in order to </span><span class="se">\</span>
<span class="s2">                call cont_overwrite_at_key_chain&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_elem_in_list</span><span class="p">(</span>
            <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">sub_cont</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;key chain must already exist in container in order to </span><span class="se">\</span>
<span class="s2">            call cont_overwrite_at_key_chain&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">sub_cont</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_set_at_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_set_at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_set_at_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set values of container object at specified key-chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_dict</span>
<span class="sd">            param return_dict: (Default value = None)</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        return_dict</span>
<span class="sd">             (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            new container with updated values at the key chains</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_set_at_key_chains</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">inplace</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_overwrite_at_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_overwrite_at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_overwrite_at_key_chains</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Overwrite values of container object at specified key-chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_dict</span>
<span class="sd">            param return_dict: (Default value = None)</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        return_dict</span>
<span class="sd">             (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            new container with updated values at the key chains, provided they</span>
<span class="sd">            existed before.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_elem_in_list</span><span class="p">(</span>
                <span class="n">k</span><span class="p">,</span>
                <span class="n">return_dict</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;key chain must already exist in container in order to </span><span class="se">\</span>
<span class="s2">                call cont_overwrite_at_key_chain&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_overwrite_at_key_chains</span><span class="p">(</span>
                    <span class="n">v</span><span class="p">,</span> <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">inplace</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_keys"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_keys">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_keys</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prune set of keys.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query_keys</span>
<span class="sd">            param ignore_none: (Default value = True)</span>
<span class="sd">        ignore_none</span>
<span class="sd">             (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container with key-chains containing the specified keys pruned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">query_keys</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">key_chains_to_prune</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">query_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">query_keys</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            x</span>
<span class="sd">                param kc:</span>
<span class="sd">            kc</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">nonlocal</span> <span class="n">key_chains_to_prune</span>
            <span class="k">for</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">query_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc</span><span class="p">:</span>
                    <span class="n">key_chains_to_prune</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_prune_key_chains</span><span class="p">(</span><span class="n">key_chains_to_prune</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_key_chain"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prune chain of keys, specified as &#39;key1/key2/key3/...&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chain</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container with keys in key chain pruned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys_in_chain</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[/.]&quot;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">new_val</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_prune_key_chain</span><span class="p">(</span>
                            <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_val</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">out_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prune set of key chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_chains</span>
<span class="sd">            param ignore_none: (Default value = True)</span>
<span class="sd">        ignore_none</span>
<span class="sd">             (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container with keys in the set of key chains pruned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_prune_key_chains_input_as_seq</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_prune_key_chains_input_as_seq</span><span class="p">([</span><span class="n">key_chains</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid type for input key_chains, must either be a list, tuple, dict &quot;</span>
                <span class="s2">&quot;or ivy.Container, but found type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key_chains</span><span class="p">))</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_format_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_format_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_format_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_fn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format all key-chains, using the formatting function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        format_fn</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container with the same key-chain structure, but the key strings formatted.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">format_fn</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">()})</span></div>

<div class="viewcode-block" id="ContainerBase.cont_sort_by_key"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_sort_by_key">[docs]</a>    <span class="k">def</span> <span class="nf">cont_sort_by_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">v_back</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">cont_sort_by_key</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_back</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_back</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_empty"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_empty">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_nones</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prunes empty keys from the container dict structure. Returns None</span>
<span class="sd">        if the entire container is empty.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keep_nones</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        base</span>
<span class="sd">            Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            Container with empty keys pruned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_prune_empty</span><span class="p">(</span><span class="n">keep_nones</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_value</span><span class="p">:</span>
                    <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">keep_nones</span><span class="p">:</span>
                <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">out_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_key_from_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_key_from_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_key_from_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prune absolute key or key containing a certain substring from all</span>
<span class="sd">        key chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        absolute</span>
<span class="sd">            The absolute key to detect in the key chains. (Default value = None)</span>
<span class="sd">        containing</span>
<span class="sd">            A substring to check each key for, when deciding which keys to prune.</span>
<span class="sd">            (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container with specified key or substring-containing-key from all key chains</span>
<span class="sd">            removed from the chain.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_all_or_any_fn</span><span class="p">(</span>
            <span class="n">absolute</span><span class="p">,</span>
            <span class="n">containing</span><span class="p">,</span>
            <span class="n">fn</span><span class="o">=</span><span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;at least one of absolute or containing must be specified&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">out_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">absolute</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">==</span> <span class="n">absolute</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">containing</span> <span class="ow">and</span> <span class="n">containing</span> <span class="ow">in</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_combine</span><span class="p">(</span><span class="n">out_cont</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_prune_key_from_key_chains</span><span class="p">(</span>
                    <span class="n">absolute</span><span class="p">,</span> <span class="n">containing</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">out_cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_prune_keys_from_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_prune_keys_from_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_prune_keys_from_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively prune absolute keys or keys containing certain substrings from</span>
<span class="sd">        all key chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        absolute</span>
<span class="sd">            The absolute key to detect in the key chains. (Default value = None)</span>
<span class="sd">        containing</span>
<span class="sd">            A substring to check each key for, when deciding which keys to prune.</span>
<span class="sd">            (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container with specified keys or substring-containing-keys from all</span>
<span class="sd">            key chains removed from the chain.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_all_or_any_fn</span><span class="p">(</span>
            <span class="n">absolute</span><span class="p">,</span>
            <span class="n">containing</span><span class="p">,</span>
            <span class="n">fn</span><span class="o">=</span><span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;at least one of absolute or containing must be specified&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">out_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">absolute</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">absolute</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">containing</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">([</span><span class="n">con</span> <span class="ow">in</span> <span class="n">key</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">containing</span><span class="p">])</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_combine</span><span class="p">(</span><span class="n">out_cont</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_prune_key_from_key_chains</span><span class="p">(</span>
                    <span class="n">absolute</span><span class="p">,</span> <span class="n">containing</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">out_cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_restructure_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_restructure_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_restructure_key_chains</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">keychain_mapping</span><span class="p">,</span> <span class="n">keep_orig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new container with the same contents, but a new key-chain structure.</span>
<span class="sd">        Given by the mapping with keys as old key-chains and values as new key-chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keychain_mapping</span>
<span class="sd">            A dict with keys as old key-chains and values as new key-chains.</span>
<span class="sd">        keep_orig</span>
<span class="sd">            Whether to keep the original keys, or start from a new empty container.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        replace</span>
<span class="sd">            Whether to replace the old key-chains by the new ones. Default is ``True``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">keep_orig</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">old_kc</span><span class="p">,</span> <span class="n">new_kc</span> <span class="ow">in</span> <span class="n">keychain_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">replace</span> <span class="ow">and</span> <span class="n">old_kc</span> <span class="ow">in</span> <span class="n">new_cont</span><span class="p">:</span>
                <span class="n">new_cont</span> <span class="o">=</span> <span class="n">new_cont</span><span class="o">.</span><span class="n">cont_prune_key_chain</span><span class="p">(</span><span class="n">old_kc</span><span class="p">)</span>
            <span class="n">new_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_combine</span><span class="p">(</span>
                <span class="n">new_cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">new_kc</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="n">old_kc</span><span class="p">]})</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_restructure"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_restructure">[docs]</a>    <span class="k">def</span> <span class="nf">cont_restructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">keep_orig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new container with the same contents, but a new key-chain structure,</span>
<span class="sd">        and transposes and/or reshaped arrays. Given by the mapping with keys as old</span>
<span class="sd">        key-chains and values as new key-chains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mapping</span>
<span class="sd">            A dict with keys as old key-chains and values as new key-chains.</span>
<span class="sd">        keep_orig</span>
<span class="sd">            Whether to keep the original keys, are start from a new container.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        replace</span>
<span class="sd">            Whether to replace the old key-chains by the new ones. Default is ``True``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">keep_orig</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">old_kc</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">replace</span> <span class="ow">and</span> <span class="n">old_kc</span> <span class="ow">in</span> <span class="n">new_cont</span><span class="p">:</span>
                <span class="n">new_cont</span> <span class="o">=</span> <span class="n">new_cont</span><span class="o">.</span><span class="n">cont_prune_key_chain</span><span class="p">(</span><span class="n">old_kc</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">old_kc</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">new_kc</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s2">&quot;key_chain&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;pattern&quot;</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
                    <span class="n">pattern</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">]</span>
                    <span class="n">axes_lengths</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s2">&quot;axes_lengths&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;axes_lengths&quot;</span> <span class="ow">in</span> <span class="n">new</span> <span class="k">else</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">einops_rearrange</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">einops_rearrange</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_kc</span> <span class="o">=</span> <span class="n">new</span>
            <span class="n">new_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_combine</span><span class="p">(</span>
                <span class="n">new_cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">new_kc</span><span class="p">:</span> <span class="n">val</span><span class="p">})</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_cont</span></div>

<div class="viewcode-block" id="ContainerBase.cont_flatten_key_chains"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_flatten_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">cont_flatten_key_chains</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        include_empty</span>
<span class="sd">            Default value = False)</span>
<span class="sd">        above_height</span>
<span class="sd">            Default value = None)</span>
<span class="sd">        below_depth</span>
<span class="sd">            Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_flatten_key_chain</span><span class="p">(</span>
                    <span class="n">kc</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="n">above_height</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="n">below_depth</span>
                <span class="p">):</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_copy"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_copy">[docs]</a>    <span class="k">def</span> <span class="nf">cont_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a copy of this container.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            A copy of the container</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont_to_dict</span><span class="p">(),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_deep_copy"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_deep_copy">[docs]</a>    <span class="k">def</span> <span class="nf">cont_deep_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a deep copy (copying all internal tensors) of this container.</span>

<span class="sd">        return: A deep copy of the container</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">copy_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_deep_copy</span><span class="p">()</span>

<div class="viewcode-block" id="ContainerBase.cont_map"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_map">[docs]</a>    <span class="k">def</span> <span class="nf">cont_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply function to all array values of container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func</span>
<span class="sd">            Function to apply to each container entry</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        map_sequences</span>
<span class="sd">            Whether to also map method to sequences (lists, tuples).</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        inplace</span>
<span class="sd">            Whether to apply the mapping inplace, or return a new container.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        key_chain</span>
<span class="sd">            Chain of keys for this dict entry (Default value = &#39;&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            New container following the function mapped to each sub-array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
                    <span class="n">func</span><span class="p">,</span>
                    <span class="n">key_chains</span><span class="p">,</span>
                    <span class="n">to_apply</span><span class="p">,</span>
                    <span class="n">prune_unapplied</span><span class="p">,</span>
                    <span class="n">map_sequences</span><span class="p">,</span>
                    <span class="n">inplace</span><span class="p">,</span>
                    <span class="n">this_key_chain</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="n">map_sequences</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_map</span><span class="p">(</span>
                    <span class="n">value</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="n">shallow</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span>
                    <span class="p">):</span>
                        <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_map_sub_conts"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_map_sub_conts">[docs]</a>    <span class="k">def</span> <span class="nf">cont_map_sub_conts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">,</span>
        <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">key_chain</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">include_self</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply function to all sub-contains in the container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func</span>
<span class="sd">            Function to apply to each sub-container</span>
<span class="sd">        key_chains</span>
<span class="sd">            The key-chains to apply or not apply the method to. Default is ``None``.</span>
<span class="sd">        to_apply</span>
<span class="sd">            If True, the method will be applied to key_chains, otherwise key_chains</span>
<span class="sd">            will be skipped. Default is ``True``.</span>
<span class="sd">        prune_unapplied</span>
<span class="sd">            Whether to prune key_chains for which the function was not applied.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        inplace</span>
<span class="sd">            Whether to apply the mapping inplace, or return a new container.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        key_chain</span>
<span class="sd">            Chain of keys for this dict entry (Default value = &#39;&#39;)</span>
<span class="sd">        include_self</span>
<span class="sd">            Whether to also apply the (possiby in-place) function to this container.</span>
<span class="sd">            Default is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            New container following the function mapped to each sub-container.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span>
                    <span class="n">func</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">this_key_chain</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="ow">and</span> <span class="n">prune_unapplied</span>
                <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">return_dict</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">include_self</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_entries_as_lists"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_entries_as_lists">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_entries_as_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">IvyBackendException</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map</span><span class="p">(</span><span class="n">to_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_reshape_like"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_reshape_like">[docs]</a>    <span class="k">def</span> <span class="nf">cont_reshape_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">leading_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_cont</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set shapes of container entries to shapes specified by new container with the</span>
<span class="sd">        same key structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_dict</span>
<span class="sd">            param leading_shape: (Default value = None)</span>
<span class="sd">        return_cont</span>
<span class="sd">            Default value = None)</span>
<span class="sd">        leading_shape</span>
<span class="sd">             (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret</span>
<span class="sd">            new container with values of updated shapes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">leading_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">leading_shape</span><span class="p">,</span> <span class="nb">list</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">return_cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">v_shape</span><span class="p">),</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">return_cont</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v_shape</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_reshape_like</span><span class="p">(</span>
                    <span class="n">v_shape</span><span class="p">,</span> <span class="n">leading_shape</span><span class="p">,</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="n">v</span><span class="p">,</span> <span class="n">leading_shape</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">v_shape</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_cont</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_create_if_absent"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_create_if_absent">[docs]</a>    <span class="k">def</span> <span class="nf">cont_create_if_absent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a key to the container with corresponding value, if it is not already</span>
<span class="sd">        present. otherwise, do nothing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key</span>
<span class="sd">            param value:</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = True)</span>
<span class="sd">        value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cont_set_at_key_chain</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_if_exists"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_if_exists">[docs]</a>    <span class="k">def</span> <span class="nf">cont_if_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the sub-container at the following key if it exists, otherwise None.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span></div>

<div class="viewcode-block" id="ContainerBase.cont_try_kc"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_try_kc">[docs]</a>    <span class="k">def</span> <span class="nf">cont_try_kc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tries the following key or key chain, returning self if not present.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">IvyException</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="ContainerBase.cont_cutoff_at_depth"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_cutoff_at_depth">[docs]</a>    <span class="k">def</span> <span class="nf">cont_cutoff_at_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        depth_cutoff</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_max_depth</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_maybe_cutoff</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">total_depth</span> <span class="o">-</span> <span class="n">copy</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span><span class="o">.</span><span class="n">cont_max_depth</span> <span class="o">&lt;</span> <span class="n">depth_cutoff</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cont</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">cont</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_maybe_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_cutoff_at_height"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_cutoff_at_height">[docs]</a>    <span class="k">def</span> <span class="nf">cont_cutoff_at_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        height_cutoff</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_maybe_cutoff</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">copy</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span><span class="o">.</span><span class="n">cont_max_depth</span> <span class="o">&gt;</span> <span class="n">height_cutoff</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cont</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">cont</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_maybe_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="k">def</span> <span class="nf">_cont_slice_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="n">ivy</span><span class="o">.</span><span class="n">assertions</span><span class="o">.</span><span class="n">check_true</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alphabetical_keys</span><span class="p">)</span>
            <span class="n">start_char</span> <span class="o">=</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">end_char</span> <span class="o">=</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">start_char</span><span class="p">])</span>
            <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_char</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">key_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>
        <span class="n">desired_keys</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">key_slice</span><span class="p">]</span>
        <span class="c1"># noinspection PyUnresolvedReferences</span>
        <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">cont_at_key_chains</span><span class="p">(</span><span class="n">desired_keys</span><span class="p">)</span>

<div class="viewcode-block" id="ContainerBase.cont_slice_keys"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_slice_keys">[docs]</a>    <span class="k">def</span> <span class="nf">cont_slice_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">,</span> <span class="n">all_depths</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_slice</span>
<span class="sd">            param all_depths: (Default value = False)</span>
<span class="sd">        all_depths</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_max_depth</span>
        <span class="k">if</span> <span class="n">all_depths</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">first_slice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key_slice</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_slice</span><span class="p">:</span>
                        <span class="n">key_slice</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_slice</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">key_slice</span> <span class="o">=</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="n">key_slice</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

            <span class="k">def</span> <span class="nf">_fn</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">kc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">kc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">depth</span> <span class="ow">in</span> <span class="n">key_slice</span><span class="p">:</span>
                    <span class="c1"># noinspection PyProtectedMember</span>
                    <span class="k">return</span> <span class="n">cont</span><span class="o">.</span><span class="n">_cont_slice_keys</span><span class="p">(</span><span class="n">key_slice</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">cont</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_slice_keys</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_print_limit"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_print_limit">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_print_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        print_limit</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_update_print_limit</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_limit</span> <span class="o">=</span> <span class="n">print_limit</span>
            <span class="k">return</span> <span class="n">cont</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_update_print_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="c1"># noinspection PyTypeChecker</span>
<div class="viewcode-block" id="ContainerBase.cont_remove_print_limit"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_remove_print_limit">[docs]</a>    <span class="k">def</span> <span class="nf">cont_remove_print_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_with_print_limit</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_key_length_limit"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_key_length_limit">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_key_length_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_length_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key_length_limit</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_update_key_length_limit</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_key_length_limit</span> <span class="o">=</span> <span class="n">key_length_limit</span>
            <span class="k">return</span> <span class="n">cont</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_update_key_length_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_remove_key_length_limit"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_remove_key_length_limit">[docs]</a>    <span class="k">def</span> <span class="nf">cont_remove_key_length_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inplace</span>
<span class="sd">            Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_with_key_length_limit</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_print_indent"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_print_indent">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_print_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_indent</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        print_indent</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_update_print_indent</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_indent</span> <span class="o">=</span> <span class="n">print_indent</span>
            <span class="k">return</span> <span class="n">cont</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_update_print_indent</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_print_line_spacing"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_print_line_spacing">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_print_line_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_line_spacing</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        print_line_spacing</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_update_print_line_spacing</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_line_spacing</span> <span class="o">=</span> <span class="n">print_line_spacing</span>
            <span class="k">return</span> <span class="n">cont</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_update_print_line_spacing</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_default_key_color"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_default_key_color">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_default_key_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_key_color</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default_key_color</span>
<span class="sd">            param inplace: (Default value = False)</span>
<span class="sd">        inplace</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_update_default_key_color</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_default_key_color</span> <span class="o">=</span> <span class="n">default_key_color</span>
            <span class="k">return</span> <span class="n">cont</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_map_sub_conts</span><span class="p">(</span><span class="n">_update_default_key_color</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.cont_with_ivy_backend"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_with_ivy_backend">[docs]</a>    <span class="k">def</span> <span class="nf">cont_with_ivy_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivy_backend</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        self</span>
<span class="sd">            input Container</span>
<span class="sd">        ivy_backend</span>
<span class="sd">            backend to use</span>
<span class="sd">        inplace</span>
<span class="sd">            whether to modify the container or return a copy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span> <span class="o">=</span> <span class="n">ivy_backend</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy_backend</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivy_backend</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContainerBase.cont_show"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_show">[docs]</a>    <span class="k">def</span> <span class="nf">cont_show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="ContainerBase.cont_show_sub_container"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.cont_show_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">cont_show_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont_or_keychain</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Summary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sub_cont_or_keychain</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># copy this container</span>
        <span class="n">this_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_copy</span><span class="p">()</span>

        <span class="c1"># get the sub-container</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_cont_or_keychain</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_at_key_chain</span><span class="p">(</span><span class="n">sub_cont_or_keychain</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont_or_keychain</span>

        <span class="c1"># find the key chain of the sub-container</span>
        <span class="n">sub_cont_kc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_find_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">)</span>

        <span class="c1"># show this container if key-chain not found, and return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_cont_kc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># otherwise, replace sub-container in this container with known key</span>
        <span class="n">this_cont</span><span class="p">[</span><span class="n">sub_cont_kc</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="s2">&quot;SUB_CONT&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>

        <span class="c1"># get the formatted reprs</span>
        <span class="n">this_repr</span> <span class="o">=</span> <span class="n">this_cont</span><span class="o">.</span><span class="n">cont_with_default_key_color</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="n">this_repr_red</span> <span class="o">=</span> <span class="n">this_cont</span><span class="o">.</span><span class="n">cont_with_default_key_color</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="n">this_repr_stripped</span> <span class="o">=</span> <span class="n">ansi_escape</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">this_repr</span><span class="p">)</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="o">.</span><span class="n">cont_with_default_key_color</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

        <span class="c1"># remove the outer brackets from the sub repr</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># find the sub-container placeholder</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;SUB_CONT: null&quot;</span><span class="p">)</span>

        <span class="c1"># count the lines above and below the sub-container</span>
        <span class="n">num_lines_above</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">num_lines_below</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># get the str reprs above and below</span>
        <span class="n">this_repr_split</span> <span class="o">=</span> <span class="n">this_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">this_repr_red_split</span> <span class="o">=</span> <span class="n">this_repr_red</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">this_repr_above</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">this_repr_split</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">num_lines_above</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">this_repr_red_split</span><span class="p">[</span><span class="n">num_lines_above</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="p">)</span>
        <span class="n">this_repr_below</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_repr_split</span><span class="p">[</span><span class="o">-</span><span class="n">num_lines_below</span><span class="p">:])</span>

        <span class="c1"># count the number of lines needed to be prepended to the sub-container repr</span>
        <span class="n">cur_num_spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_repr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">cur_num_spaces</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">exp_num_spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">this_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="n">num_lines_above</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">exp_num_spaces</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">num_spaces_to_add</span> <span class="o">=</span> <span class="n">exp_num_spaces</span> <span class="o">-</span> <span class="n">cur_num_spaces</span>

        <span class="c1"># prepend these lines to the sub-container</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">num_spaces_to_add</span> <span class="o">+</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sub_repr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># show</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">this_repr_above</span> <span class="o">+</span> <span class="n">sub_repr</span> <span class="o">+</span> <span class="n">this_repr_below</span><span class="p">)</span></div>

    <span class="c1"># Built-ins #</span>
    <span class="c1"># ----------#</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="n">indent_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_indent</span>

        <span class="k">def</span> <span class="nf">_align_array</span><span class="p">(</span><span class="n">array_str_in</span><span class="p">):</span>
            <span class="n">array_str_in_split</span> <span class="o">=</span> <span class="n">array_str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;([&quot;</span><span class="p">)</span>
            <span class="n">leading_str_to_keep</span> <span class="o">=</span> <span class="n">array_str_in_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">indented_key_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;: &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">indented_key_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indented_key_size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">padded</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">def</span> <span class="nf">_pre_pad_alpha_line</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">padded</span>
                <span class="n">padded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span> <span class="o">+</span> <span class="n">indent_str</span> <span class="o">+</span> <span class="n">indented_key_str</span> <span class="o">+</span> <span class="n">str_in</span>

            <span class="n">leading_str_to_keep</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">_pre_pad_alpha_line</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">s</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">))</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">local_indent_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">padded</span> <span class="k">else</span> <span class="n">indent_str</span>
            <span class="n">leading_str</span> <span class="o">=</span> <span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">remaining_str</span> <span class="o">=</span> <span class="n">array_str_in_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">num_extra_dims</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">remaining_str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">char</span> <span class="o">!=</span> <span class="s2">&quot;[&quot;</span><span class="p">:</span>
                    <span class="n">num_extra_dims</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>
            <span class="n">extra_indent</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">leading_str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">num_extra_dims</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span>
            <span class="n">array_str_in</span> <span class="o">=</span> <span class="s2">&quot;([&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">leading_str_to_keep</span><span class="p">,</span> <span class="n">remaining_str</span><span class="p">])</span>
            <span class="n">uniform_indent_wo_overflow</span> <span class="o">=</span> <span class="n">array_str_in</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n[&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">local_indent_str</span> <span class="o">+</span> <span class="n">extra_indent</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span>
            <span class="p">)</span>
            <span class="n">uniform_indent_wo_overflow_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">uniform_indent_wo_overflow</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">uniform_indent</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">local_indent_str</span> <span class="o">+</span> <span class="n">extra_indent</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">s</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span>
                        <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span>
                        <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;...&quot;</span>
                        <span class="ow">or</span> <span class="nb">max</span><span class="p">([</span><span class="n">ss</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nan, &quot;</span><span class="p">,</span> <span class="s2">&quot;inf, &quot;</span><span class="p">]])</span>
                    <span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span>
                        <span class="n">indent_str</span> <span class="o">+</span> <span class="n">indented_key_str</span> <span class="o">+</span> <span class="n">s</span>
                        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                        <span class="k">else</span> <span class="n">s</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">uniform_indent_wo_overflow_list</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">indented</span> <span class="o">=</span> <span class="n">uniform_indent</span>
            <span class="c1"># 10 dimensions is a sensible upper bound for the number in a single array</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">indented</span> <span class="o">=</span> <span class="n">indented</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;[&quot;</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">indented</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">indented</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">isspace</span><span class="p">()]</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">indented</span>

        <span class="k">def</span> <span class="nf">_align_arrays</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="n">str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">indent_str</span><span class="p">)</span>
            <span class="n">aligned_array_chunks</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">i</span><span class="p">:</span> <span class="n">_align_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span> <span class="ow">in</span> <span class="n">c</span>
            <span class="p">}</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">aligned_array_chunks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">aligned_array_chunks</span> <span class="k">else</span> <span class="n">c_orig</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c_orig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">indent_str</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="c1"># noinspection PyArgumentList</span>
                <span class="n">rep</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="n">as_repr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">is_native_array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span>
                <span class="p">):</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="s2">&quot;shape=&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="n">v</span>
                    <span class="ow">and</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span><span class="o">.</span><span class="n">is_native_array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;_asdict&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span><span class="p">:</span>
                            <span class="n">rep</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                                <span class="p">[</span>
                                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span>
                                    <span class="k">else</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> = </span><span class="si">{}</span><span class="s2">, shape=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                        <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                                    <span class="p">)</span>
                                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>
                                <span class="p">],</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span>
                                <span class="s2">&quot;NamedTuple(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span>
                                <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                <span class="s2">&quot;shape=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
                            <span class="p">)</span>

                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="s2">&quot;tuple(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span>
                            <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                            <span class="s2">&quot;shape=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="s2">&quot;list[</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span>
                            <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                            <span class="s2">&quot;shape=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
                        <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rep</span>
        <span class="k">if</span> <span class="n">as_repr</span><span class="p">:</span>
            <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="n">_align_arrays</span><span class="p">(</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">cont_map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span>
                        <span class="k">if</span> <span class="n">_is_jsonable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">else</span> <span class="n">_repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="o">.</span><span class="n">cont_to_dict</span><span class="p">(),</span>
                    <span class="n">indent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_indent</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="k">def</span> <span class="nf">_add_newline</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
                <span class="n">str_in_split</span> <span class="o">=</span> <span class="n">str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">str_split_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_in_split</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_line_spacing</span> <span class="o">+</span> <span class="n">ss</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">str_split_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span> <span class="n">ss</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">str_in_split</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>

            <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="s1">&#39;&quot;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="n">_add_newline</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="c1"># improve tf formatting</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">backend_stack</span> <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">current_backend_str</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;tensorflow&quot;</span><span class="p">:</span>
                <span class="n">json_dumped_str_split</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;Variable:&quot;</span><span class="p">)</span>
                <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">json_dumped_str_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
                            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">json_dumped_str_split</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:shape&quot;</span><span class="p">,</span> <span class="s2">&quot;, shape&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)dtype=&quot;</span><span class="p">,</span> <span class="s2">&quot;), dtype=&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, ),&quot;</span><span class="p">,</span> <span class="s2">&quot;,),&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;}, $&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="n">json_dumped_str</span><span class="p">)</span>
            <span class="c1"># color keys</span>
            <span class="n">json_dumped_str_split</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
            <span class="n">split_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_dumped_str_split</span><span class="p">)</span>
            <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="s1">&#39;&quot;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s1">&#39; &quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">sub_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &quot;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="o">+</span> <span class="p">[</span>
                            <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span>
                                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">cont_trim_key</span><span class="p">(</span>
                                    <span class="n">sub_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &quot;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_length_limit</span>
                                <span class="p">),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_default_key_color</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">split_size</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">else</span> <span class="n">sub_str</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub_str</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">json_dumped_str_split</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># remove quotation marks, shape tuple, and color other elements of the dict</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &#39;shape=&#39;, [&quot;</span><span class="p">,</span> <span class="s2">&quot; shape=[&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;shape=&quot;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;shape=&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;device=&quot;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;device=&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;class&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;class &#39;&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;class&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="c1"># ToDo: make the solution below more elegant</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;diff_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;diff_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyword_color_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">color</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="k">return</span> <span class="n">new_dict</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">super</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># noinspection PyProtectedMember</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># noinspection PyUnresolvedReferences</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># raise error</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                            <span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="n">item</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="k">else</span> <span class="n">attr</span>
                <span class="n">ret</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_queue_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">IvyException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid slice type, must be one of integer, slice &quot;</span>
                <span class="s2">&quot;or sequences of slices.&quot;</span>
            <span class="p">)</span>
        <span class="n">queue_idxs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queue_queries</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">conts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">queue_idxs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">:</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_timeout</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span>
                <span class="p">)</span><span class="o">.</span><span class="n">to_ivy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">conts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">combined_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">(</span><span class="n">conts</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queue_idxs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="n">query</span> <span class="o">-</span> <span class="n">offset</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="nb">slice</span><span class="p">(</span><span class="n">slc</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">slc</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">slc</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">slc</span> <span class="ow">in</span> <span class="n">query</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="c1"># noinspection PyUnboundLocalVariable</span>
        <span class="k">return</span> <span class="n">combined_cont</span><span class="p">[</span><span class="n">shifted_query</span><span class="p">]</span>

<div class="viewcode-block" id="ContainerBase.__getitem__"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get slice, key or key chain of container object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query slice or str</span>
<span class="sd">            slice object, key or key chain to query all container elements.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Container object at desired query.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">query</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">query</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_at_key_chain</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ret</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="k">elif</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_queue_item</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># noinspection PyBroadException</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="ContainerBase.__setitem__"><a class="viewcode-back" href="../../../data_classes/container/base/ContainerBase.html#ivy.container.base.ContainerBase.__setitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set key or key chain of container object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query slice or str</span>
<span class="sd">            slice object, key or key chain at which to set all container elements.</span>
<span class="sd">        val ivy.Container, array, or other</span>
<span class="sd">            The value to set at the desired query.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            New container after updating.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">query</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">query</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_set_at_key_chain</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_has_key_chain</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_contains_sub_container</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_local_ivy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_local_ivy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">current_backend_str</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">config_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config_in&quot;</span><span class="p">])</span>
        <span class="n">config_in</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">config_in</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">current_backend_str</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config_in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_in</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config&quot;</span><span class="p">])</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">current_backend_str</span><span class="p">())</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
        <span class="k">return</span> <span class="n">state_dict</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;_local_ivy&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_local_ivy&quot;</span><span class="p">]):</span>
                <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_local_ivy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_local_ivy&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;_config_in&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="n">config_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config_in&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;ivyh&quot;</span> <span class="ow">in</span> <span class="n">config_in</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config_in</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]):</span>
                    <span class="n">config_in</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="n">config_in</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">])</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config_in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_in</span>
        <span class="k">if</span> <span class="s2">&quot;_config&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;ivyh&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]):</span>
                    <span class="n">config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;ivyh&quot;</span><span class="p">])</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="s2">&quot;_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>

    <span class="c1"># Getters and Setters #</span>
    <span class="c1"># --------------------#</span>

    <span class="c1"># private</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_cont_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_local_ivy</span><span class="p">,</span> <span class="n">ivy</span><span class="p">)</span>

    <span class="nd">@_cont_ivy</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">_cont_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_ivy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_ivy</span> <span class="o">=</span> <span class="n">local_ivy</span>

    <span class="c1"># public</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The shape of the arrays in the container, with None placed in indices which</span>
<span class="sd">        are not consistent across arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_get_shape</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The shapes of each array in the container, with None placed in leaf entries</span>
<span class="sd">        without a shape attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_get_shapes</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The device to which the arrays in the container belong, with None returned if</span>
<span class="sd">        the devices are not consistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_get_dev</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_dev_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The device to which the arrays in the container belong, with None returned if</span>
<span class="sd">        the devices are not consistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_get_dev</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont_ivy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cont_max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">kcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont_to_iterator_keys</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kcs</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">kc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">kcs</span><span class="p">])</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Ivy Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>